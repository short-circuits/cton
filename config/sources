
CTON_SOURCES="$CTON_MODULES_C     \
            src/core/cton.c       \
            src/core/tbon.c       \
            src/core/utils.c      \
            src/exchange/json.c   \
            src/exchange/base64.c \
            src/crypto/sha1.c"

if [ $CTON_CORE = YES ]; then
    feature=CTON_WITH_CORE value=1 . config/utils/define
fi

if [ $CTON_EXCHANGE = YES ]; then
    feature=CTON_WITH_EXCHANGE value=1 . config/utils/define

    if [ $CTON_EXCHANGE_JSON = YES ]; then
        feature=CTON_WITH_EXCHANGE_JSON value=1 . config/utils/define
    fi

    if [ $CTON_EXCHANGE_BASE64 = YES ]; then
        feature=CTON_WITH_EXCHANGE_BASE64 value=1 . config/utils/define
    fi
    
fi

if [ $CTON_CRYPTO = YES ]; then
    feature=CTON_WITH_CRYPTO value=1 . config/utils/define

    if [ $CTON_CRYPTO_SHA1 = YES ]; then
        feature=CTON_WITH_CRYPTO_SHA1 value=1 . config/utils/define
    fi
    
fi


CTON_MODULE_HEADERS="src/cton_json.h \
                     src/cton_bmp.h"

for cton_module_header in $CTON_MODULE_HEADERS; do
	cat $cton_module_header >> $CTON_MODULES_H
done

sed "/\/\* CTON_MODULE_FUNCS \*\//r $CTON_MODULES_H" \
    < src/cton.h > $CTON_BUILD_DIR/cton.h
